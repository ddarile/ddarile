<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Мои чаты - D DARILE</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat+Alternates&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
    <script defer src="jquery.js"></script>
    <link rel="stylesheet" href="styles/menu_style.css">
    <link rel="stylesheet" href="styles/chats_style.css">
</head>

<body>
    <div id="burger-menu" class="burger-menu">
        <button id="close-menu" class="close-button">✕</button>
        <nav class="burger-nav">
            <a href="/profile" class="burger-link">Профиль</a>
            <a href="/cart" class="burger-link">Оформление заказа</a>
            <a href="/" class="burger-link">Главная</a>
            <a href="/services" class="burger-link">Каталог услуг</a>
            <a href="/portfolio" class="burger-link">Портфолио наших дизайнеров</a>
            <a href="/team" class="burger-link">Команда D Darile</a>
            <a href="/comments" class="burger-link">Отзывы о студии</a>
            <a href="/chats" class="burger-link" id="burger-link-guestion">Есть вопросы? Напишите нам!</a>
        </nav>
    </div>

    <header class="header">
        <div class="header-left">
            <button id="open-menu" class="menu-button">
                <div class="menu-button-container">
                    <span class="menu-icon-line line-1"></span>
                    <span class="menu-icon-line line-2"></span>
                    <span class="menu-icon-line line-3"></span>
                </div>
                <span class="menu-text">Меню</span>
            </button>
            <div class="catalog-dropdown" id="catalog-dropdown">
                <span class="catalog-text">Каталог услуг</span>
                <svg class="dropdown-arrow" width="12" height="6" viewBox="0 0 12 6" fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <path d="M1 1L6 5L11 1" stroke="white" stroke-width="1.5" />
                </svg>
                <div class="dropdown-content" id="dropdown-content">
                    <a href="/services/graphic">Графический дизайн</a>
                    <a href="/services/uiux">UI/UX Дизайн</a>
                    <a href="/services/game">Game Дизайн</a>
                    <a href="/services/web">Веб-дизайн</a>
                    <a href="/services/3d">3D-дизайн</a>
                    <a href="/services/typography">Типографика</a>
                </div>
            </div>
        </div>

        <div class="header-center">
            <div class="logo">
                <img src="pictures/logo1.svg" alt="DD+">
            </div>
        </div>

        <div class="header-right">
            <div class="notification-dropdown" id="notification-dropdown">
                <a href="#" class="icon-link notification-icon" id="notification-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="1.5">
                        <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                        <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                    </svg>
                    <span class="notification-badge"></span>
                </a>
                <div class="notification-content" id="notification-content">
                    <div class="notification-header">
                        <h3>Уведомления</h3>
                    </div>
                    <div class="notification-list">
                        <div class="notification-item unread">
                            <div class="notification-content-container">
                                <div class="notification-text">Ваш заказ #12345 был успешно оформлен</div>
                                <div class="notification-time">2 часа назад</div>
                            </div>
                        </div>
                        <div class="notification-item">
                            <div class="notification-content-container">
                                <div class="notification-text">Добро пожаловать в D DARILE! Ваш профиль успешно создан.
                                </div>
                                <div class="notification-time">1 день назад</div>
                            </div>
                        </div>
                        <div class="notification-item">
                            <div class="notification-content-container">
                                <div class="notification-text">У вас одно новое сообщение в чате по заказу #12341</div>
                                <div class="notification-time">3 дня назад</div>
                            </div>
                        </div>
                    </div>
                    <div class="notification-footer">
                        <a href="#" class="mark-all-read">Отметить все как прочитанные</a>
                    </div>
                </div>
            </div>

            <a href="/profile" class="icon-link">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                </svg>
            </a>
        </div>
    </header>

  <main class="chats-main">
  <div class="chats-container">
    <!-- Левая панель со списком чатов -->
    <div class="chats-sidebar" id="chatsSidebar">
      <div class="chats-header">
        <h1 class="chats-title">МОИ ЧАТЫ</h1>
      </div>

      <div class="chats-list" id="chatsList">
        <% chats.forEach((chat, index) => { %>
          <div class="chat-item <%= index === 0 ? 'active' : '' %>" data-chat-id="<%= chat.id_chat %>">
            <div class="chat-info">
              <div class="chat-name"><%= chat.chat_name.toUpperCase() %></div>
              <div class="chat-meta">
                <%= chat.opponent_name %>
              </div>
              <% if (chat.chat_date) { %>
                <div class="chat-order"><%= chat.chat_date %></div>
              <% } %>
            </div>
            <% if (chat.has_unread) { %>
              <div class="chat-notification"></div>
            <% } %>
          </div>
        <% }) %>
      </div>
    </div>

    <!-- Правая панель с чатом -->
    <div class="chat-area" id="chatArea">
      <!-- Заголовок чата -->
      <div class="chat-header" id="chatHeader">
        <div class="chat-header-left">
          <button class="back-btn" id="backToChats">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5"></path>
              <path d="M12 19l-7-7 7-7"></path>
            </svg>
          </button>
          <h2 class="chat-title" id="chatTitle"><%= chats[0] ? chats[0].chat_name.toUpperCase() : 'Чат' %></h2>
        </div>
        <button class="chat-files-btn-header" id="chatFilesBtn">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path>
          </svg>
        </button>
      </div>

      <!-- Область сообщений -->
      <div class="messages-area" id="messagesArea">
        <div class="messages-container" id="messagesContainer">
          <!-- Сообщения будут добавляться динамически через JS -->
        </div>
      </div>

      <!-- Поле ввода сообщения -->
      <div class="message-input-area" id="messageInputArea">
        <div class="message-input-container">
          <button class="attach-btn" id="attachBtn">
            <svg width="25" height="25" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M12 5v14M5 12h14"></path>
            </svg>
          </button>
          <input type="text" class="message-input" id="messageInput" placeholder="Введите сообщение...">
          <button class="send-btn" id="sendBtn">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="22" y1="2" x2="11" y2="13"></line>
              <polygon points="22,2 15,22 11,13 2,9 22,2"></polygon>
            </svg>
          </button>
        </div>
      </div>

      <!-- Состояние "Чат не выбран" -->
      <div class="no-chat-selected" id="noChatSelected" style="display: none;">
        <div class="no-chat-message">Чат не выбран</div>
      </div>
    </div>
  </div>
</main>


    <!-- Модальное окно для прикрепления файлов -->
    <div id="attachModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Прикрепить файл</h3>
                <span class="close" id="attachModalClose">&times;</span>
            </div>
            <div class="modal-body">
                <div class="file-upload-area" id="fileUploadArea">
                    <input type="file" id="fileInput" multiple accept="image/*,.pdf,.doc,.docx,.txt">
                    <div class="file-upload-content">
                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                            <path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path>
                        </svg>
                        <p>Нажмите или перетащите файлы сюда</p>
                        <span>Поддерживаются: изображения, PDF, документы</span>
                    </div>
                </div>
                <div class="selected-files" id="selectedFiles"></div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="cancelAttach">Отмена</button>
                <button class="btn btn-primary" id="confirmAttach">Прикрепить</button>
            </div>
        </div>
    </div>

    <!-- Модальное окно для просмотра файлов чата -->
    <div id="filesModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Файлы чата</h3>
                <span class="close" id="filesModalClose">&times;</span>
            </div>
            <div class="modal-body">
                <div class="chat-files-list" id="chatFilesList">
                    <!-- Файлы будут добавлены динамически -->
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="closeFilesModal">Закрыть</button>
            </div>
        </div>
    </div>

    <script src="scripts/menu_script.js"></script>
    <script src="scripts/chats_script.js"></script>
</body>

</html>
